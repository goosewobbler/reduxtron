<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8" />
		<title>add todo</title>
		<!-- https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP -->
		<meta
			http-equiv="Content-Security-Policy"
			content="script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'"
		/>
	</head>

	<body>
		<div>
			<h1 style="margin: 0">add todo</h1>
			<h2 style="font-size: 1.25rem; margin: 0; color: fuchsia">powered by vanilla jsâ„¢</h2>
			<form id="form">
				<input id="input" />
				<button type="submit">add to do</button>
			</form>
		</div>
	</body>
	<script>
		const form = document.getElementById('form')
		const input = document.getElementById('input')

		const commitDraft = () => window.electron.dispatch({ type: 'TO_DO:COMMIT_DRAFT' })
		const setDraft = payload => window.electron.dispatch({ type: 'TO_DO:SET_DRAFT', payload })

		form.addEventListener('submit', e => {
			e.preventDefault()
			commitDraft()
		})

		input.addEventListener('input', e => setDraft(e.target.value))

		window.electron.subscribe(newState => {
			input.value = newState.toDos.draft
		})
	</script>
</html>
